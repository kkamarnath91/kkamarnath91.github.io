<!DOCTYPE html>
<html>
  <head>
    <script src="//code.jquery.com/jquery-2.1.1.min.js"></script>
    <!--
    Load CartoDB's code so we can pull in our CartoDB maps.
    -->
    <link rel="stylesheet" href="http://libs.cartocdn.com/cartodb.js/v3/3.15/themes/css/cartodb.css" />
    <script src="http://libs.cartocdn.com/cartodb.js/v3/3.15/cartodb.js"></script>
    
    <style>
      html, body {
        height: 100%;
        margin: 0;
        padding: 0;
        width: 100%;
      }

      #map {
        height: 100%;
        width: 100%;
      }
      
      .sl_districtbankchange-checkbox-wrapper {
        position: absolute;
        top: 15px;
        right: 15px;
      }
    </style>

    <script>
      var dataLayer;
      $(document).ready(function () {
        //
        // Initialize map from CartoDB: create the map and store the data layer for later
        //
        cartodb.createVis('map', 'https://amark490.cartodb.com/api/v2/viz/e4adf5da-0758-11e6-8ee2-0e787de82d45/viz.json')
          .done(function (vis, layers) {
            // Store the data layer for later:
            //  * layers[0] is the base layer (eg OpenStreetMap)
            //  * layers[1] is where all of your data layers go, and they're stored as "sublayers". The first one is numbered 0, the second is 1, etc. In this case we're getting the first sublayer.
            dataLayer = layers[1].getSubLayer(0);
          });

        //
        // Initialize the checkbox: add an event handler to watch for change
        //
        $('.sl_districtbankchange-checkbox').change(function () {
          var sql = "SELECT * FROM sl_districtbankchange";
          if ($(this).is(':checked')) {
            sql = SELECT * FROM sl_districtbankchange WHERE (banden2014 >= 14) AND (bankchange >= 35);
          }
          dataLayer.setSQL(sql);
        });
      });
    </script>
  </head>
  <body>
    <div id="map"></div>
    <div class="sl_districtbankchange-checkbox-wrapper">
      <input type="checkbox" class="sl_districtbankchange-checkbox">Only Districts With Change Above 35%
    </div>
  </body>
</html>
